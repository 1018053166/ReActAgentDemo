# MCP 生态集成管理平台 - 产品设计文档

**文档版本**: v1.0
**创建日期**: 2025-12-03
**文档状态**: 初稿

---

## 目录

1. [模块一：平台首页](#模块一平台首页)
2. [模块二：MCP服务器列表](#模块二mcp服务器列表)
3. [模块三：MCP服务器详情页](#模块三mcp服务器详情页)
4. [模块四：分类与标签管理系统](#模块四分类与标签管理系统)
5. [模块五：用户账户系统](#模块五用户账户系统)
6. [模块六：组织与团队管理](#模块六组织与团队管理)
7. [模块七：MCP提交与审核系统](#模块七mcp提交与审核系统)
8. [模块八：版本管理系统](#模块八版本管理系统)
9. [模块九：HTTP接口转MCP协议](#模块九http接口转mcp协议)
10. [模块十：在线测试Playground](#模块十在线测试playground)
11. [模块十一：部署管理服务](#模块十一部署管理服务)
12. [模块十二：监控告警系统](#模块十二监控告警系统)
13. [模块十三：AI智能推荐系统](#模块十三ai智能推荐系统)
14. [模块十四：新手引导与教程](#模块十四新手引导与教程)
15. [模块十五：管理后台系统](#模块十五管理后台系统)
16. [模块十六：开放平台与API](#模块十六开放平台与api)

---

# 模块一：平台首页

## 1.1 模块概述

### 1.1.1 模块定位
平台首页是用户访问MCP生态集成管理平台的第一入口，承担着品牌展示、内容分发、用户引导三大核心职责。首页需要在有限的屏幕空间内，帮助不同类型的用户（开发者、企业用户、普通用户）快速找到所需的MCP资源，同时展示平台的核心价值和活跃度。

### 1.1.2 目标用户
| 用户类型 | 核心诉求 | 首页关注点 |
|---------|---------|-----------|
| 新访客 | 了解平台是什么、能做什么 | 平台介绍、精选推荐、入门引导 |
| 开发者 | 快速找到需要的MCP工具 | 搜索、分类导航、热门排行 |
| 企业用户 | 评估平台规模和可信度 | 统计数据、官方认证、企业案例 |
| 回访用户 | 发现新内容、继续之前的操作 | 最新上架、个性化推荐、历史记录 |

### 1.1.3 设计原则
- **信息层次清晰**：核心信息优先展示，通过视觉层次引导用户注意力
- **快速触达**：任何MCP资源在3次点击内可达
- **动态更新**：首页内容保持新鲜度，体现平台活跃度
- **响应式适配**：PC、平板、手机三端体验一致

---

## 1.2 页面布局设计

### 1.2.1 整体布局结构

```
┌─────────────────────────────────────────────────────────────────┐
│                         顶部导航栏 (固定)                         │
├─────────────────────────────────────────────────────────────────┤
│                         公告通知横幅 (可关闭)                      │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│                    Hero区域 (搜索框 + 统计数据)                    │
│                                                                 │
├─────────────────────────────────────────────────────────────────┤
│                         分类导航区域                              │
├───────────────────────────────────┬─────────────────────────────┤
│                                   │                             │
│         精选推荐轮播区域            │       热门排行榜区域          │
│                                   │                             │
├───────────────────────────────────┴─────────────────────────────┤
│                                                                 │
│                        最新上架列表区域                           │
│                                                                 │
├─────────────────────────────────────────────────────────────────┤
│                         页脚信息区域                              │
└─────────────────────────────────────────────────────────────────┘
```

### 1.2.2 响应式断点设计

| 断点 | 屏幕宽度 | 布局调整 |
|-----|---------|---------|
| 大屏 | ≥1440px | 四列布局，完整展示所有模块 |
| 桌面 | 1024-1439px | 三列布局，侧边栏收窄 |
| 平板 | 768-1023px | 两列布局，部分模块堆叠 |
| 手机 | <768px | 单列布局，模块垂直排列 |

---

## 1.3 功能详细设计

### 1.3.1 功能点 F1.1：平台数据统计概览

#### 业务场景
```
场景一：新访客评估平台
- 用户角色：首次访问的开发者
- 用户目标：判断平台是否值得信任和使用
- 使用路径：进入首页 → 查看统计数据 → 了解平台规模
- 期望结果：通过数据了解平台活跃度，增强使用信心

场景二：运营人员监控
- 用户角色：平台运营人员
- 用户目标：快速了解平台当前运营状况
- 使用路径：进入首页 → 查看统计数据 → 发现异常或增长
- 期望结果：及时掌握平台核心指标变化
```

#### 用户故事
```
US-1.1.1: 作为一名新访客，我希望在首页看到平台的核心统计数据，以便快速了解平台的规模和活跃程度。
US-1.1.2: 作为一名回访用户，我希望看到数据的变化趋势，以便了解平台的发展动态。
US-1.1.3: 作为一名运营人员，我希望统计数据实时更新，以便及时发现异常情况。
```

#### 界面设计说明

**布局位置**：Hero区域下方，横向排列的统计卡片组

**统计指标卡片设计**：
```
┌──────────────────┐
│    📦 12,580     │  ← 主数据（大字体、醒目颜色）
│   MCP服务器总数   │  ← 指标名称（小字体、灰色）
│    ↑ 128 本周    │  ← 变化趋势（绿色上升/红色下降）
└──────────────────┘
```

**展示的统计指标**：
| 指标名称 | 数据来源 | 更新频率 | 展示格式 |
|---------|---------|---------|---------|
| MCP服务器总数 | mcp_server表COUNT | 1小时 | 12,580 |
| 官方认证数量 | source_type='official' | 1小时 | 856 |
| 注册用户总数 | sys_user表COUNT | 1小时 | 45,230 |
| 本周新增MCP | 7天内created_at | 1小时 | +128 |
| 累计调用次数 | 调用日志聚合 | 1小时 | 1.2亿 |

**数据格式化规则**：
- 数字≥10000时，显示为"1.2万"格式
- 数字≥100000000时，显示为"1.2亿"格式
- 变化趋势正数显示"↑"绿色，负数显示"↓"红色，零显示"—"灰色

#### 数据模型

**统计数据缓存表 sys_statistics_cache**：
```sql
CREATE TABLE sys_statistics_cache (
    id BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT '主键ID',
    stat_key VARCHAR(50) NOT NULL COMMENT '统计指标键名',
    stat_value BIGINT NOT NULL DEFAULT 0 COMMENT '统计值',
    stat_value_formatted VARCHAR(20) COMMENT '格式化后的显示值',
    change_value INT DEFAULT 0 COMMENT '变化值（与上周期对比）',
    change_percent DECIMAL(5,2) COMMENT '变化百分比',
    stat_period VARCHAR(20) NOT NULL COMMENT '统计周期：hour/day/week/month',
    calculated_at DATETIME NOT NULL COMMENT '计算时间',
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    UNIQUE KEY uk_key_period (stat_key, stat_period)
) COMMENT '统计数据缓存表';
```

#### 接口设计

**接口1：获取首页统计数据**
```yaml
接口路径: GET /api/v1/home/statistics
请求参数: 无
响应格式:
  {
    "code": 200,
    "message": "success",
    "data": {
      "totalMcpCount": {
        "value": 12580,
        "formatted": "12,580",
        "change": 128,
        "changePercent": 1.03,
        "trend": "up"
      },
      "officialCount": {
        "value": 856,
        "formatted": "856",
        "change": 12,
        "changePercent": 1.42,
        "trend": "up"
      },
      "totalUserCount": {
        "value": 45230,
        "formatted": "4.5万",
        "change": 1205,
        "changePercent": 2.74,
        "trend": "up"
      },
      "weeklyNewMcp": {
        "value": 128,
        "formatted": "128",
        "change": 15,
        "changePercent": 13.27,
        "trend": "up"
      },
      "totalCallCount": {
        "value": 120000000,
        "formatted": "1.2亿",
        "change": 5000000,
        "changePercent": 4.35,
        "trend": "up"
      },
      "updatedAt": "2025-12-03T10:00:00Z"
    }
  }
缓存策略: Redis缓存，TTL=3600秒
性能要求: 响应时间<100ms
```

#### 业务规则

| 规则编号 | 规则描述 | 规则详情 |
|---------|---------|---------|
| BR-1.1.1 | 数据更新频率 | 统计数据每小时通过定时任务计算一次，计算结果写入缓存表 |
| BR-1.1.2 | 数据格式化 | 数字超过1万显示"x.x万"，超过1亿显示"x.x亿"，保留1位小数 |
| BR-1.1.3 | 变化趋势计算 | 本周期数据与上周期数据对比，计算变化值和变化百分比 |
| BR-1.1.4 | 异常数据处理 | 统计值为负数或计算失败时，显示上次有效值并标记为"数据更新中" |
| BR-1.1.5 | 缓存降级 | Redis缓存失效时，从数据库缓存表读取，数据库也失败时返回默认值 |

---

### 1.3.2 功能点 F1.2：精选推荐轮播展示

#### 业务场景
```
场景一：新用户发现优质MCP
- 用户角色：首次访问的开发者
- 用户目标：快速了解平台有哪些优质MCP
- 使用路径：进入首页 → 浏览精选轮播 → 点击感兴趣的MCP
- 期望结果：发现符合需求的高质量MCP

场景二：运营配置推荐内容
- 用户角色：平台运营人员
- 用户目标：推广优质MCP或合作伙伴内容
- 使用路径：后台配置 → 设置轮播内容 → 前台展示
- 期望结果：目标MCP获得更多曝光和点击
```

#### 用户故事
```
US-1.2.1: 作为一名新访客，我希望在首页看到平台精选的优质MCP，以便快速发现高质量资源。
US-1.2.2: 作为一名运营人员，我希望能够配置轮播内容的展示顺序和时间，以便进行精准运营。
US-1.2.3: 作为一名用户，我希望轮播能够自动播放但不影响我的浏览，以便获得良好的使用体验。
```

#### 界面设计说明

**轮播区域布局**：
```
┌─────────────────────────────────────────────────────────────┐
│  ┌─────────────────────────────────────────────────────┐   │
│  │                                                     │   │
│  │    [MCP图标]                                        │   │
│  │                                                     │   │
│  │    Filesystem MCP                                   │   │
│  │    安全的文件操作服务，支持读写、目录管理等功能         │   │
│  │                                                     │   │
│  │    [官方] [文件操作] [热门]                          │   │
│  │                                                     │   │
│  │    [立即使用]  [了解更多]                            │   │
│  │                                                     │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│                    ● ○ ○ ○ ○                              │  ← 轮播指示器
│                                                             │
│              [<]                    [>]                     │  ← 手动切换按钮
└─────────────────────────────────────────────────────────────┘
```

**轮播项内容结构**：
| 元素 | 说明 | 数据来源 |
|-----|------|---------|
| 背景图/渐变色 | 轮播项背景，支持自定义图片或渐变色 | banner_config.background |
| MCP图标 | 64x64像素的MCP图标 | mcp_server.icon_url |
| MCP名称 | 主标题，最多20字符 | mcp_server.name |
| 推荐语 | 副标题，最多50字符 | banner_config.description |
| 标签列表 | 最多显示3个标签 | mcp_server.tags |
| 主按钮 | "立即使用"，跳转详情页 | 固定文案 |
| 副按钮 | "了解更多"，跳转文档 | 固定文案 |

**轮播交互规则**：
| 交互行为 | 响应动作 |
|---------|---------|
| 自动播放 | 每5秒自动切换到下一张，鼠标悬停时暂停 |
| 点击指示器 | 切换到对应轮播项 |
| 点击左右箭头 | 切换到上一张/下一张 |
| 触摸滑动(移动端) | 左滑下一张，右滑上一张 |
| 点击轮播项 | 跳转到MCP详情页 |

#### 数据模型

**首页轮播配置表 home_banner_config**：
```sql
CREATE TABLE home_banner_config (
    id BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT '主键ID',
    mcp_server_id BIGINT COMMENT '关联的MCP服务器ID，可为空（自定义内容时）',
    banner_type TINYINT NOT NULL DEFAULT 1 COMMENT '轮播类型：1-MCP推荐 2-活动推广 3-公告通知',
    title VARCHAR(50) NOT NULL COMMENT '轮播标题',
    description VARCHAR(200) COMMENT '轮播描述',
    background_type TINYINT NOT NULL DEFAULT 1 COMMENT '背景类型：1-渐变色 2-图片',
    background_value VARCHAR(500) COMMENT '背景值：渐变色CSS或图片URL',
    link_url VARCHAR(500) COMMENT '点击跳转链接',
    link_target VARCHAR(20) DEFAULT '_self' COMMENT '链接打开方式：_self/_blank',
    button_text VARCHAR(20) DEFAULT '立即查看' COMMENT '按钮文案',
    sort_order INT NOT NULL DEFAULT 0 COMMENT '排序权重，越大越靠前',
    start_time DATETIME COMMENT '展示开始时间，空表示立即生效',
    end_time DATETIME COMMENT '展示结束时间，空表示永久有效',
    status TINYINT NOT NULL DEFAULT 1 COMMENT '状态：0-禁用 1-启用',
    click_count INT DEFAULT 0 COMMENT '点击次数统计',
    created_by BIGINT COMMENT '创建人ID',
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    INDEX idx_status_sort (status, sort_order DESC),
    INDEX idx_time_range (start_time, end_time)
) COMMENT '首页轮播配置表';
```

#### 接口设计

**接口1：获取首页轮播列表**
```yaml
接口路径: GET /api/v1/home/banners
请求参数:
  - position: string, 可选, 轮播位置（home_top/home_middle）
  - limit: int, 可选, 返回数量，默认5
响应格式:
  {
    "code": 200,
    "message": "success",
    "data": {
      "banners": [
        {
          "id": 1,
          "bannerType": 1,
          "title": "Filesystem MCP",
          "description": "安全的文件操作服务，支持读写、目录管理等功能",
          "backgroundType": 1,
          "backgroundValue": "linear-gradient(135deg, #667eea 0%, #764ba2 100%)",
          "linkUrl": "/mcp/filesystem",
          "linkTarget": "_self",
          "buttonText": "立即使用",
          "mcpServer": {
            "id": 101,
            "name": "Filesystem",
            "iconUrl": "https://xxx/icon.png",
            "tags": ["官方", "文件操作", "热门"]
          }
        }
      ],
      "total": 5
    }
  }
缓存策略: Redis缓存，TTL=300秒，配置变更时主动失效
性能要求: 响应时间<50ms
```

**接口2：记录轮播点击**
```yaml
接口路径: POST /api/v1/home/banners/{bannerId}/click
请求参数:
  - bannerId: long, 必填, 轮播ID
请求体: 无
响应格式:
  {
    "code": 200,
    "message": "success"
  }
业务逻辑: 异步更新点击计数，不阻塞用户操作
```

#### 业务规则

| 规则编号 | 规则描述 | 规则详情 |
|---------|---------|---------|
| BR-1.2.1 | 展示数量 | 首页最多展示5个轮播项 |
| BR-1.2.2 | 排序规则 | 按sort_order降序，相同权重按创建时间降序 |
| BR-1.2.3 | 时间控制 | 只展示当前时间在start_time和end_time范围内的轮播 |
| BR-1.2.4 | 状态过滤 | 只展示status=1的启用状态轮播 |
| BR-1.2.5 | 自动播放 | 默认5秒切换，用户鼠标悬停时暂停播放 |
| BR-1.2.6 | 点击统计 | 点击事件异步记录，用于运营数据分析 |

---

### 1.3.3 功能点 F1.3：热门排行榜单展示

#### 业务场景
```
场景一：用户发现热门MCP
- 用户角色：寻找工具的开发者
- 用户目标：找到最受欢迎、经过验证的MCP
- 使用路径：进入首页 → 查看热门排行 → 选择感兴趣的MCP
- 期望结果：快速找到社区认可的优质MCP

场景二：MCP作者查看排名
- 用户角色：MCP开发者
- 用户目标：了解自己MCP的排名情况
- 使用路径：进入首页 → 查看排行榜 → 关注排名变化
- 期望结果：了解MCP的市场表现
```

#### 用户故事
```
US-1.3.1: 作为一名开发者，我希望看到不同维度的排行榜，以便从多角度发现优质MCP。
US-1.3.2: 作为一名用户，我希望看到排名变化趋势，以便了解哪些MCP正在快速增长。
US-1.3.3: 作为一名MCP作者，我希望看到完整的排行榜，以便了解自己MCP的具体排名。
```

#### 界面设计说明

**排行榜区域布局**：
```
┌─────────────────────────────────────────┐
│  热门排行                    [查看全部 >] │
├─────────────────────────────────────────┤
│  [周下载量] [月调用量] [收藏量] [好评率]   │  ← 排行榜切换选项卡
├─────────────────────────────────────────┤
│  1  ↑2  [图标] Filesystem      12.5K ↑  │
│  2  ↓1  [图标] Database        10.2K ↓  │
│  3  —   [图标] Web Search       8.7K —  │
│  4  ↑5  [图标] Code Assistant   7.3K ↑  │
│  5  NEW [图标] Image Process    6.1K ↑  │
│  ...                                    │
│  10 ↓2  [图标] Email Service    3.2K ↓  │
└─────────────────────────────────────────┘
```

**排行榜项目结构**：
| 元素 | 说明 | 样式 |
|-----|------|------|
| 排名数字 | 当前排名，1-3名特殊样式 | 1金色/2银色/3铜色 |
| 排名变化 | ↑上升/↓下降/—持平/NEW新上榜 | 绿色/红色/灰色/蓝色 |
| MCP图标 | 32x32像素圆形图标 | 圆角头像 |
| MCP名称 | 最多显示15字符 | 可点击跳转 |
| 指标数值 | 格式化的统计数值 | 右对齐 |
| 数值变化 | ↑增长/↓下降 | 小号字体 |

**排行榜类型**：
| 排行类型 | 统计周期 | 数据来源 | 排序规则 |
|---------|---------|---------|---------|
| 周下载量 | 最近7天 | 下载日志聚合 | 下载量降序 |
| 月调用量 | 最近30天 | 调用日志聚合 | 调用量降序 |
| 收藏量 | 累计 | user_favorite表 | 收藏数降序 |
| 好评率 | 累计 | mcp_comment表 | 评分降序（评价数≥10） |

#### 数据模型

**排行榜数据表 mcp_ranking**：
```sql
CREATE TABLE mcp_ranking (
    id BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT '主键ID',
    mcp_server_id BIGINT NOT NULL COMMENT 'MCP服务器ID',
    ranking_type VARCHAR(30) NOT NULL COMMENT '排行类型：weekly_download/monthly_call/favorite/rating',
    ranking_period VARCHAR(20) NOT NULL COMMENT '排行周期：如 2025-W49, 2025-11',
    current_rank INT NOT NULL COMMENT '当前排名',
    previous_rank INT COMMENT '上期排名，NULL表示新上榜',
    rank_change INT COMMENT '排名变化，正数上升负数下降',
    metric_value BIGINT NOT NULL COMMENT '指标数值',
    metric_change BIGINT COMMENT '指标变化值',
    calculated_at DATETIME NOT NULL COMMENT '计算时间',
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    UNIQUE KEY uk_mcp_type_period (mcp_server_id, ranking_type, ranking_period),
    INDEX idx_type_period_rank (ranking_type, ranking_period, current_rank)
) COMMENT 'MCP排行榜数据表';
```

#### 接口设计

**接口：获取排行榜数据**
```yaml
接口路径: GET /api/v1/home/rankings
请求参数:
  - type: string, 必填, 排行类型（weekly_download/monthly_call/favorite/rating）
  - limit: int, 可选, 返回数量，默认10，最大100
响应格式:
  {
    "code": 200,
    "message": "success",
    "data": {
      "rankingType": "weekly_download",
      "rankingPeriod": "2025-W49",
      "updatedAt": "2025-12-03T00:00:00Z",
      "items": [
        {
          "rank": 1,
          "previousRank": 3,
          "rankChange": 2,
          "changeType": "up",
          "mcpServer": {
            "id": 101,
            "name": "Filesystem",
            "slug": "filesystem",
            "iconUrl": "https://xxx/icon.png",
            "sourceType": "official"
          },
          "metricValue": 12500,
          "metricFormatted": "12.5K",
          "metricChange": 3200,
          "metricChangePercent": 34.4
        }
      ],
      "total": 10
    }
  }
缓存策略: Redis缓存，TTL=3600秒
性能要求: 响应时间<100ms
```

#### 业务规则

| 规则编号 | 规则描述 | 规则详情 |
|---------|---------|---------|
| BR-1.3.1 | 计算周期 | 周排行每周一凌晨计算，月排行每月1日凌晨计算 |
| BR-1.3.2 | 排名范围 | 只统计status=1的已上架MCP |
| BR-1.3.3 | 好评率门槛 | 好评率排行要求评价数≥10条，避免小样本偏差 |
| BR-1.3.4 | 新上榜标识 | 上期无排名记录的MCP显示"NEW"标识 |
| BR-1.3.5 | 数值格式化 | ≥1000显示K，≥1000000显示M，保留1位小数 |
| BR-1.3.6 | 首页展示 | 首页默认展示前10名，点击"查看全部"跳转完整榜单页 |

---

### 1.3.4 功能点 F1.4：最新上架动态列表

#### 业务场景
```
场景一：用户追踪新MCP
- 用户角色：活跃开发者
- 用户目标：及时了解平台新增的MCP资源
- 使用路径：进入首页 → 浏览最新上架 → 发现新工具
- 期望结果：第一时间发现可能有用的新MCP

场景二：作者确认上架
- 用户角色：刚提交MCP的开发者
- 用户目标：确认自己的MCP已成功上架
- 使用路径：提交审核通过 → 访问首页 → 在最新上架中找到自己的MCP
- 期望结果：看到自己的MCP出现在最新上架列表
```

#### 用户故事
```
US-1.4.1: 作为一名活跃用户，我希望看到最近上架的MCP列表，以便及时发现新资源。
US-1.4.2: 作为一名MCP作者，我希望看到上架时间，以便确认发布成功。
US-1.4.3: 作为一名用户，我希望列表能够加载更多内容，以便浏览更多历史上架记录。
```

#### 界面设计说明

**最新上架区域布局**：
```
┌─────────────────────────────────────────────────────────────────┐
│  最新上架                                        [查看更多 >]    │
├─────────────────────────────────────────────────────────────────┤
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────┐│
│  │   [图标]    │  │   [图标]    │  │   [图标]    │  │  [图标] ││
│  │  MCP名称    │  │  MCP名称    │  │  MCP名称    │  │ MCP名称 ││
│  │  简介文字   │  │  简介文字   │  │  简介文字   │  │ 简介... ││
│  │  [标签]     │  │  [标签]     │  │  [标签]     │  │ [标签]  ││
│  │  3小时前    │  │  5小时前    │  │  1天前      │  │  2天前  ││
│  └─────────────┘  └─────────────┘  └─────────────┘  └─────────┘│
└─────────────────────────────────────────────────────────────────┘
```

**列表项结构**：
| 元素 | 说明 | 样式 |
|-----|------|------|
| MCP图标 | 48x48像素 | 圆角矩形 |
| MCP名称 | 最多15字符 | 标题字体，可点击 |
| 简介 | 最多30字符，超出省略 | 正文字体，灰色 |
| 标签 | 最多显示2个 | 小号标签样式 |
| 上架时间 | 相对时间格式 | 小号字体，灰色 |

**时间格式化规则**：
| 时间范围 | 显示格式 | 示例 |
|---------|---------|------|
| <1分钟 | 刚刚 | 刚刚 |
| <1小时 | x分钟前 | 30分钟前 |
| <24小时 | x小时前 | 5小时前 |
| <7天 | x天前 | 3天前 |
| ≥7天 | 月/日 | 11/25 |

#### 接口设计

**接口：获取最新上架列表**
```yaml
接口路径: GET /api/v1/home/latest
请求参数:
  - limit: int, 可选, 返回数量，默认8，最大20
  - offset: int, 可选, 偏移量，默认0
响应格式:
  {
    "code": 200,
    "message": "success",
    "data": {
      "items": [
        {
          "id": 201,
          "name": "New MCP Tool",
          "slug": "new-mcp-tool",
          "description": "这是一个新上架的MCP工具，提供...",
          "iconUrl": "https://xxx/icon.png",
          "tags": ["工具", "效率"],
          "author": {
            "id": 1001,
            "nickname": "开发者A",
            "avatarUrl": "https://xxx/avatar.png"
          },
          "publishedAt": "2025-12-03T07:30:00Z",
          "publishedAtFormatted": "3小时前"
        }
      ],
      "total": 128,
      "hasMore": true
    }
  }
缓存策略: Redis缓存，TTL=300秒，有新MCP上架时主动失效
性能要求: 响应时间<100ms
```

#### 业务规则

| 规则编号 | 规则描述 | 规则详情 |
|---------|---------|---------|
| BR-1.4.1 | 数据范围 | 只展示最近7天内上架的MCP |
| BR-1.4.2 | 排序规则 | 按published_at降序排列 |
| BR-1.4.3 | 状态过滤 | 只展示status=1的已上架MCP |
| BR-1.4.4 | 首页数量 | 首页默认展示8个，响应式布局调整为4/6/8个 |
| BR-1.4.5 | 缓存更新 | 有新MCP上架时，通过消息队列触发缓存更新 |

---

### 1.3.5 功能点 F1.5：分类导航快捷入口

#### 业务场景
```
场景一：按需求查找MCP
- 用户角色：有明确需求的开发者
- 用户目标：快速找到特定类型的MCP
- 使用路径：进入首页 → 点击对应分类 → 浏览分类列表
- 期望结果：快速进入目标分类，缩小搜索范围
```

#### 用户故事
```
US-1.5.1: 作为一名开发者，我希望在首页看到主要的MCP分类，以便快速进入感兴趣的分类。
US-1.5.2: 作为一名用户，我希望看到每个分类的MCP数量，以便了解各分类的资源丰富程度。
```

#### 界面设计说明

**分类导航布局**：
```
┌─────────────────────────────────────────────────────────────────────────┐
│  分类导航                                                                │
├─────────────────────────────────────────────────────────────────────────┤
│  ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌───────┐│
│  │  📁     │ │  🗄️    │ │  🌐     │ │  💻     │ │  🤖     │ │  📧   ││
│  │ 文件操作 │ │ 数据存储 │ │ 网络通信 │ │ 开发工具 │ │ AI增强  │ │ 更多  ││
│  │  (1,256) │ │  (892)  │ │  (743)  │ │  (1,089)│ │  (567)  │ │  ...  ││
│  └─────────┘ └─────────┘ └─────────┘ └─────────┘ └─────────┘ └───────┘│
└─────────────────────────────────────────────────────────────────────────┘
```

**分类项结构**：
| 元素 | 说明 |
|-----|------|
| 分类图标 | 32x32像素emoji或自定义图标 |
| 分类名称 | 一级分类名称，最多6字符 |
| MCP数量 | 该分类下的MCP总数 |

#### 接口设计

**接口：获取首页分类导航**
```yaml
接口路径: GET /api/v1/home/categories
请求参数:
  - limit: int, 可选, 返回数量，默认8
响应格式:
  {
    "code": 200,
    "message": "success",
    "data": {
      "categories": [
        {
          "id": 1,
          "name": "文件操作",
          "slug": "file-operation",
          "icon": "📁",
          "iconUrl": null,
          "mcpCount": 1256,
          "sortOrder": 1
        }
      ],
      "total": 8
    }
  }
缓存策略: Redis缓存，TTL=3600秒
```

---

### 1.3.6 功能点 F1.6：全局搜索入口组件

#### 业务场景
```
场景一：精确搜索MCP
- 用户角色：知道目标MCP名称的用户
- 用户目标：快速找到特定的MCP
- 使用路径：进入首页 → 输入关键词 → 查看搜索结果
- 期望结果：直接找到目标MCP

场景二：模糊探索MCP
- 用户角色：有大致需求的用户
- 用户目标：找到满足需求的MCP
- 使用路径：输入需求关键词 → 浏览搜索建议 → 选择合适的MCP
- 期望结果：通过搜索建议发现合适的MCP
```

#### 用户故事
```
US-1.6.1: 作为一名用户，我希望在首页快速搜索MCP，以便直接找到需要的工具。
US-1.6.2: 作为一名用户，我希望看到搜索建议和热门搜索词，以便在不知道确切名称时也能找到MCP。
US-1.6.3: 作为一名用户，我希望搜索框记住我的搜索历史，以便快速重复之前的搜索。
```

#### 界面设计说明

**搜索框组件**：
```
┌─────────────────────────────────────────────────────────────┐
│  🔍  搜索MCP名称、功能、标签...                    [搜索]    │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼ (输入时展开)
┌─────────────────────────────────────────────────────────────┐
│  搜索历史                                        [清空历史]  │
│  ┌─────────┐ ┌─────────┐ ┌─────────┐                       │
│  │filesystem│ │database │ │websocket│                       │
│  └─────────┘ └─────────┘ └─────────┘                       │
├─────────────────────────────────────────────────────────────┤
│  热门搜索                                                   │
│  ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐          │
│  │ 文件操作 │ │  AI助手  │ │ 数据库  │ │ 代码生成 │          │
│  └─────────┘ └─────────┘ └─────────┘ └─────────┘          │
├─────────────────────────────────────────────────────────────┤
│  搜索建议 (输入关键词后显示)                                 │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ 🔍 filesystem - 文件系统操作相关MCP                   │   │
│  │ 🔍 file-manager - 文件管理工具                        │   │
│  │ 🔍 file-converter - 文件格式转换                      │   │
│  └─────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────┘
```

**搜索交互流程**：
| 用户操作 | 系统响应 |
|---------|---------|
| 点击搜索框 | 展开下拉面板，显示搜索历史和热门搜索 |
| 输入关键词 | 300ms防抖后请求搜索建议API |
| 选择搜索建议 | 跳转到MCP详情页或搜索结果页 |
| 按回车键 | 跳转到搜索结果列表页 |
| 点击搜索按钮 | 跳转到搜索结果列表页 |
| 点击历史记录 | 填充到搜索框并执行搜索 |
| 点击热门搜索 | 填充到搜索框并执行搜索 |

#### 数据模型

**搜索历史表 user_search_history**：
```sql
CREATE TABLE user_search_history (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    user_id BIGINT NOT NULL COMMENT '用户ID，未登录用户使用设备指纹',
    keyword VARCHAR(100) NOT NULL COMMENT '搜索关键词',
    search_count INT DEFAULT 1 COMMENT '搜索次数',
    last_search_at DATETIME NOT NULL COMMENT '最后搜索时间',
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    UNIQUE KEY uk_user_keyword (user_id, keyword),
    INDEX idx_user_time (user_id, last_search_at DESC)
) COMMENT '用户搜索历史表';

-- 热门搜索词表
CREATE TABLE hot_search_keyword (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    keyword VARCHAR(100) NOT NULL COMMENT '搜索关键词',
    search_count INT DEFAULT 0 COMMENT '搜索次数',
    stat_period VARCHAR(20) NOT NULL COMMENT '统计周期：daily/weekly',
    is_recommended TINYINT DEFAULT 0 COMMENT '是否运营推荐',
    sort_order INT DEFAULT 0 COMMENT '排序权重',
    status TINYINT DEFAULT 1 COMMENT '状态：0-隐藏 1-显示',
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    UNIQUE KEY uk_keyword_period (keyword, stat_period)
) COMMENT '热门搜索词表';
```

#### 接口设计

**接口1：获取搜索建议**
```yaml
接口路径: GET /api/v1/search/suggestions
请求参数:
  - q: string, 必填, 搜索关键词，最少2个字符
  - limit: int, 可选, 返回数量，默认5
响应格式:
  {
    "code": 200,
    "message": "success",
    "data": {
      "suggestions": [
        {
          "type": "mcp",
          "id": 101,
          "name": "Filesystem",
          "slug": "filesystem",
          "matchedField": "name",
          "highlight": "<em>File</em>system"
        },
        {
          "type": "keyword",
          "keyword": "file operation",
          "searchCount": 1250
        }
      ]
    }
  }
缓存策略: 不缓存，实时查询ES
性能要求: 响应时间<200ms
```

**接口2：获取热门搜索词**
```yaml
接口路径: GET /api/v1/search/hot-keywords
请求参数:
  - limit: int, 可选, 返回数量，默认8
响应格式:
  {
    "code": 200,
    "data": {
      "keywords": ["文件操作", "AI助手", "数据库", "代码生成"]
    }
  }
缓存策略: Redis缓存，TTL=3600秒
```

**接口3：获取搜索历史**
```yaml
接口路径: GET /api/v1/search/history
请求头: Authorization: Bearer {token}
请求参数:
  - limit: int, 可选, 返回数量，默认10
响应格式:
  {
    "code": 200,
    "data": {
      "history": ["filesystem", "database", "websocket"]
    }
  }
```

---

### 1.3.7 功能点 F1.7：平台公告通知横幅

#### 业务场景
```
场景一：发布重要公告
- 用户角色：平台运营人员
- 用户目标：向用户传达重要信息
- 使用路径：后台配置公告 → 用户访问首页 → 看到公告横幅
- 期望结果：用户及时了解平台重要信息
```

#### 用户故事
```
US-1.7.1: 作为一名用户，我希望看到平台的重要公告，以便了解最新动态和注意事项。
US-1.7.2: 作为一名用户，我希望能够关闭不感兴趣的公告，以便减少干扰。
US-1.7.3: 作为一名运营人员，我希望配置不同类型和优先级的公告，以便精准传达信息。
```

#### 界面设计说明

**公告横幅布局**：
```
┌─────────────────────────────────────────────────────────────────────────┐
│ ⚠️ 系统升级通知：平台将于12月5日凌晨2:00-4:00进行系统维护...  [了解详情]  [×] │
└─────────────────────────────────────────────────────────────────────────┘
```

**公告类型样式**：
| 公告类型 | 背景色 | 图标 | 用途 |
|---------|-------|------|------|
| 通知(info) | 蓝色 | ℹ️ | 一般性通知 |
| 警告(warning) | 橙色 | ⚠️ | 需要注意的信息 |
| 紧急(urgent) | 红色 | 🚨 | 紧急重要信息 |
| 活动(promotion) | 紫色 | 🎉 | 活动推广 |

#### 数据模型

**平台公告表 sys_announcement**：
```sql
CREATE TABLE sys_announcement (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    title VARCHAR(100) NOT NULL COMMENT '公告标题',
    content TEXT COMMENT '公告详细内容',
    summary VARCHAR(200) COMMENT '公告摘要，用于横幅显示',
    announcement_type VARCHAR(20) NOT NULL DEFAULT 'info' COMMENT '公告类型：info/warning/urgent/promotion',
    link_url VARCHAR(500) COMMENT '了解详情链接',
    position VARCHAR(30) DEFAULT 'home_top' COMMENT '展示位置',
    start_time DATETIME COMMENT '展示开始时间',
    end_time DATETIME COMMENT '展示结束时间',
    is_closeable TINYINT DEFAULT 1 COMMENT '是否可关闭：0-否 1-是',
    sort_order INT DEFAULT 0 COMMENT '排序权重',
    status TINYINT DEFAULT 1 COMMENT '状态：0-禁用 1-启用',
    created_by BIGINT,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
) COMMENT '平台公告表';
```

#### 接口设计

**接口：获取首页公告**
```yaml
接口路径: GET /api/v1/home/announcements
请求参数:
  - position: string, 可选, 展示位置，默认home_top
响应格式:
  {
    "code": 200,
    "data": {
      "announcements": [
        {
          "id": 1,
          "title": "系统升级通知",
          "summary": "平台将于12月5日凌晨2:00-4:00进行系统维护...",
          "type": "warning",
          "linkUrl": "/announcements/1",
          "isCloseable": true
        }
      ]
    }
  }
```

#### 业务规则

| 规则编号 | 规则描述 | 规则详情 |
|---------|---------|---------|
| BR-1.7.1 | 展示数量 | 首页最多同时展示1条公告横幅 |
| BR-1.7.2 | 优先级 | urgent > warning > promotion > info，同类型按sort_order排序 |
| BR-1.7.3 | 关闭记忆 | 用户关闭公告后，在当前会话期间不再显示该公告 |
| BR-1.7.4 | 时间控制 | 只展示当前时间在start_time和end_time范围内的公告 |

---

## 1.4 页面状态设计

### 1.4.1 加载状态
| 区域 | 加载状态展示 |
|-----|-------------|
| 统计数据 | 数字使用骨架屏占位，显示"--"格式 |
| 轮播区域 | 显示渐变色骨架屏，高度与实际轮播相同 |
| 排行榜 | 列表项使用骨架屏，显示10行占位 |
| 最新上架 | 卡片使用骨架屏，显示8个占位卡片 |
| 分类导航 | 图标和文字使用骨架屏占位 |

### 1.4.2 空状态
| 区域 | 空状态展示 |
|-----|-------------|
| 排行榜 | 显示"暂无排行数据"提示 |
| 最新上架 | 显示"暂无新上架MCP"提示 |
| 搜索历史 | 显示"暂无搜索历史"提示 |

### 1.4.3 错误状态
| 错误类型 | 处理方式 |
|---------|---------|
| 网络错误 | 显示"网络异常，请稍后重试"，提供重试按钮 |
| 服务器错误 | 显示"服务暂时不可用"，展示缓存数据或降级内容 |
| 接口超时 | 显示上次成功加载的数据，顶部toast提示"数据更新中" |

---

## 1.5 性能优化策略

### 1.5.1 首屏加载优化
| 优化项 | 实现方式 |
|-------|---------|
| 关键CSS内联 | 首屏关键样式内联到HTML，避免阻塞渲染 |
| 图片懒加载 | 非首屏图片使用IntersectionObserver延迟加载 |
| 组件异步加载 | 轮播组件、排行榜组件按需加载 |
| 预加载提示 | 使用link rel="preload"预加载关键资源 |

### 1.5.2 数据加载优化
| 优化项 | 实现方式 |
|-------|---------|
| 接口合并 | 首页数据通过单一聚合接口返回，减少请求数 |
| 数据缓存 | 使用service worker缓存静态数据 |
| 增量更新 | 动态数据支持增量更新，减少数据传输量 |
| 预取数据 | 用户hover分类时预取分类列表数据 |

---

## 1.6 埋点与数据统计

### 1.6.1 页面级埋点
| 事件名 | 触发时机 | 携带参数 |
|-------|---------|---------|
| page_view | 页面加载完成 | page_name, referrer |
| page_stay | 页面离开时 | duration, scroll_depth |

### 1.6.2 模块级埋点
| 事件名 | 触发时机 | 携带参数 |
|-------|---------|---------|
| banner_view | 轮播项曝光 | banner_id, position |
| banner_click | 轮播项点击 | banner_id, position |
| ranking_tab_switch | 排行榜切换 | ranking_type |
| ranking_item_click | 排行项点击 | mcp_id, rank, ranking_type |
| category_click | 分类点击 | category_id, category_name |
| search_focus | 搜索框获得焦点 | - |
| search_submit | 搜索提交 | keyword, suggestion_used |
| latest_item_click | 最新上架点击 | mcp_id, position |

---

---

# 模块二：MCP服务器列表

## 2.1 模块概述

### 2.1.1 模块定位
MCP服务器列表页是用户浏览、搜索和发现MCP资源的核心页面，承担着内容展示、精准筛选、高效检索三大核心职责。该页面需要在海量MCP数据中帮助用户快速找到符合需求的目标资源，同时提供良好的浏览体验和操作效率。

### 2.1.2 目标用户
| 用户类型 | 核心诉求 | 页面关注点 |
|---------|---------|-----------|
| 探索型用户 | 浏览发现感兴趣的MCP | 卡片展示、分类筛选、推荐排序 |
| 目标型用户 | 快速找到特定MCP | 搜索功能、精确筛选 |
| 对比型用户 | 比较多个MCP的差异 | 批量选择、对比功能 |
| 回访用户 | 继续之前的浏览 | 筛选条件记忆、浏览历史 |

### 2.1.3 设计原则
- **信息密度适中**：在展示足够信息的同时避免信息过载
- **筛选高效直观**：多维度筛选条件清晰可见，支持组合使用
- **操作便捷流畅**：常用操作一键可达，减少操作步骤
- **性能优先**：大数据量下保持流畅体验

---

## 2.2 页面布局设计

### 2.2.1 整体布局结构

```
┌─────────────────────────────────────────────────────────────────────────┐
│                              顶部导航栏                                  │
├─────────────────────────────────────────────────────────────────────────┤
│  面包屑导航：首页 > MCP服务器列表 > 文件操作                               │
├─────────────────────────────────────────────────────────────────────────┤
│  ┌───────────────────────────────────────────────────────────────────┐ │
│  │  🔍 搜索MCP...                                          [搜索]   │ │
│  └───────────────────────────────────────────────────────────────────┘ │
├─────────────────────────────────────────────────────────────────────────┤
│  [全部] [今日推荐] [精选] [最新] [官方认证] [托管服务]      ← 选项卡导航   │
├────────────────────┬────────────────────────────────────────────────────┤
│                    │                                                    │
│   筛选面板         │            MCP列表区域                              │
│                    │                                                    │
│  ┌──────────────┐ │  排序：[综合推荐 ▼]  视图：[卡片] [列表]  共1,256个  │
│  │ 功能分类     │ │  ─────────────────────────────────────────────────  │
│  │ ☐ 文件操作   │ │                                                    │
│  │ ☐ 数据存储   │ │  ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐  │
│  │ ☐ 网络通信   │ │  │  MCP卡片 │ │  MCP卡片 │ │  MCP卡片 │ │  MCP卡片 │  │
│  │ ☐ 开发工具   │ │  └─────────┘ └─────────┘ └─────────┘ └─────────┘  │
│  │ [展开更多]   │ │                                                    │
│  ├──────────────┤ │  ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐  │
│  │ 来源类型     │ │  │  MCP卡片 │ │  MCP卡片 │ │  MCP卡片 │ │  MCP卡片 │  │
│  │ ☐ 官方      │ │  └─────────┘ └─────────┘ └─────────┘ └─────────┘  │
│  │ ☐ 认证      │ │                                                    │
│  │ ☐ 社区      │ │  ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐  │
│  │ ☐ 托管      │ │  │  MCP卡片 │ │  MCP卡片 │ │  MCP卡片 │ │  MCP卡片 │  │
│  ├──────────────┤ │  └─────────┘ └─────────┘ └─────────┘ └─────────┘  │
│  │ 运行环境     │ │                                                    │
│  │ ☐ Node.js   │ │             [加载更多] 或 分页导航                   │
│  │ ☐ Python    │ │                                                    │
│  │ ☐ Docker    │ │                                                    │
│  ├──────────────┤ │                                                    │
│  │ 评分区间     │ │                                                    │
│  │ ☐ 4.5分以上 │ │                                                    │
│  │ ☐ 4.0分以上 │ │                                                    │
│  └──────────────┘ │                                                    │
│                    │                                                    │
│  [重置筛选]        │                                                    │
│                    │                                                    │
└────────────────────┴────────────────────────────────────────────────────┘
```

### 2.2.2 响应式布局适配

| 断点 | 屏幕宽度 | 布局调整 |
|-----|---------|---------|
| 大屏 | ≥1440px | 左侧筛选240px固定，右侧4列卡片 |
| 桌面 | 1024-1439px | 左侧筛选200px固定，右侧3列卡片 |
| 平板 | 768-1023px | 筛选收起为顶部下拉，2列卡片 |
| 手机 | <768px | 筛选收起为弹出抽屉，1列卡片 |

---

## 2.3 功能详细设计

### 2.3.1 功能点 F2.1：卡片式列表展示布局

#### 业务场景
```
场景一：浏览发现MCP
- 用户角色：探索型开发者
- 用户目标：浏览平台MCP资源，发现感兴趣的工具
- 使用路径：进入列表页 → 浏览卡片 → 点击感兴趣的卡片
- 期望结果：通过卡片快速了解MCP概况，找到感兴趣的资源

场景二：快速评估MCP
- 用户角色：有经验的开发者
- 用户目标：快速判断MCP是否符合需求
- 使用路径：浏览卡片信息 → 查看标签和统计 → 决定是否深入了解
- 期望结果：无需进入详情页即可完成初步筛选
```

#### 用户故事
```
US-2.1.1: 作为一名开发者，我希望在卡片上看到MCP的核心信息，以便快速了解其功能和质量。
US-2.1.2: 作为一名用户，我希望卡片有悬停预览效果，以便获取更多信息而无需点击进入。
US-2.1.3: 作为一名用户，我希望可以直接在卡片上进行收藏操作，以便快速标记感兴趣的MCP。
```

#### 界面设计说明

**MCP卡片详细结构**：
```
┌─────────────────────────────────────┐
│  ┌─────┐                      [♡]  │  ← 收藏按钮
│  │     │  MCP名称                  │
│  │ 图标 │  作者名称                 │
│  │     │                          │
│  └─────┘  [官方] [文件操作]        │  ← 来源标签 + 分类标签
├─────────────────────────────────────┤
│                                     │
│  这是MCP的简介描述文字，最多显示两   │
│  行，超出部分使用省略号...          │
│                                     │
├─────────────────────────────────────┤
│  ⭐ 4.8 (126)   📥 12.5K   🔧 8    │  ← 评分/下载量/工具数
└─────────────────────────────────────┘
```

**卡片元素规格**：
| 元素 | 规格 | 数据来源 |
|-----|------|---------|
| 卡片尺寸 | 宽度自适应，高度固定200px | - |
| MCP图标 | 56×56px，圆角8px | mcp_server.icon_url |
| 名称 | 最多20字符，单行，超出省略 | mcp_server.name |
| 作者 | 最多15字符，单行 | sys_user.nickname |
| 来源标签 | 官方/认证/社区/托管，单个 | mcp_server.source_type |
| 分类标签 | 一级分类名称，单个 | mcp_category.name |
| 简介 | 最多60字符，两行，超出省略 | mcp_server.description |
| 评分 | 五星制，保留1位小数 | 计算字段 |
| 评价数 | 格式化数字 | mcp_comment COUNT |
| 下载量 | 格式化数字 | 统计字段 |
| 工具数 | 整数 | mcp_tool COUNT |

**卡片悬停效果**：
| 交互状态 | 视觉变化 |
|---------|---------|
| 默认状态 | 白色背景，浅灰边框 |
| 悬停状态 | 轻微上浮，阴影加深，边框变蓝 |
| 点击状态 | 背景轻微变灰 |
| 收藏按钮悬停 | 心形图标变红 |

**卡片悬停预览浮层**（鼠标悬停500ms后显示）：
```
┌─────────────────────────────────────────┐
│  Filesystem MCP                         │
│  ─────────────────────────────────────  │
│  完整描述文字，最多显示150字符...        │
│                                         │
│  工具列表：                              │
│  • read_file - 读取文件内容              │
│  • write_file - 写入文件内容             │
│  • list_directory - 列出目录             │
│  • ...共8个工具                         │
│                                         │
│  [查看详情]  [在线测试]  [复制配置]       │
└─────────────────────────────────────────┘
```

#### 数据模型

**MCP服务器主表 mcp_server**：
```sql
CREATE TABLE mcp_server (
    id BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT '主键ID',
    name VARCHAR(100) NOT NULL COMMENT 'MCP名称',
    slug VARCHAR(100) NOT NULL COMMENT 'URL友好标识',
    description VARCHAR(500) COMMENT '简短描述',
    full_description TEXT COMMENT '完整描述（Markdown）',
    icon_url VARCHAR(500) COMMENT '图标URL',

    -- 来源信息
    source_type VARCHAR(20) NOT NULL DEFAULT 'community' COMMENT '来源类型：official/verified/community/hosted',
    github_url VARCHAR(500) COMMENT 'GitHub仓库地址',
    doc_url VARCHAR(500) COMMENT '文档地址',
    homepage_url VARCHAR(500) COMMENT '官网地址',

    -- 技术信息
    runtime_env VARCHAR(30) COMMENT '运行环境：nodejs/python/docker/go',
    transport_type VARCHAR(30) DEFAULT 'stdio' COMMENT '传输协议：stdio/sse/websocket',
    install_command VARCHAR(500) COMMENT '安装命令',
    version VARCHAR(30) COMMENT '当前版本号',

    -- 分类信息
    category_id BIGINT COMMENT '一级分类ID',
    sub_category_id BIGINT COMMENT '二级分类ID',

    -- 作者信息
    author_id BIGINT NOT NULL COMMENT '作者用户ID',
    org_id BIGINT COMMENT '所属组织ID',

    -- 可见性
    visibility VARCHAR(20) DEFAULT 'public' COMMENT '可见性：public/org/team/private',

    -- 统计字段（冗余，定时更新）
    download_count INT DEFAULT 0 COMMENT '下载次数',
    favorite_count INT DEFAULT 0 COMMENT '收藏次数',
    call_count BIGINT DEFAULT 0 COMMENT '调用次数',
    tool_count INT DEFAULT 0 COMMENT '工具数量',
    rating_avg DECIMAL(2,1) DEFAULT 0.0 COMMENT '平均评分',
    rating_count INT DEFAULT 0 COMMENT '评价数量',

    -- 状态
    status TINYINT DEFAULT 0 COMMENT '状态：0-草稿 1-待审核 2-已上架 3-已下架 4-已拒绝',
    is_featured TINYINT DEFAULT 0 COMMENT '是否精选',

    -- 时间
    published_at DATETIME COMMENT '上架时间',
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,

    UNIQUE KEY uk_slug (slug),
    INDEX idx_category (category_id),
    INDEX idx_author (author_id),
    INDEX idx_status (status),
    INDEX idx_source_type (source_type),
    INDEX idx_published_at (published_at DESC),
    INDEX idx_download_count (download_count DESC),
    INDEX idx_rating_avg (rating_avg DESC)
) COMMENT 'MCP服务器主表';
```

#### 接口设计

**接口：获取MCP列表**
```yaml
接口路径: GET /api/v1/mcp/servers
请求参数:
  - keyword: string, 可选, 搜索关键词
  - categoryId: long, 可选, 分类ID
  - sourceTypes: string[], 可选, 来源类型数组
  - runtimeEnvs: string[], 可选, 运行环境数组
  - minRating: float, 可选, 最低评分
  - tags: string[], 可选, 标签数组
  - tab: string, 可选, 选项卡（all/featured/latest/official/hosted）
  - sortBy: string, 可选, 排序字段（default/latest/downloads/rating/favorites）
  - sortOrder: string, 可选, 排序方向（asc/desc）
  - page: int, 可选, 页码，默认1
  - pageSize: int, 可选, 每页数量，默认20，最大100

响应格式:
  {
    "code": 200,
    "message": "success",
    "data": {
      "items": [
        {
          "id": 101,
          "name": "Filesystem",
          "slug": "filesystem",
          "description": "安全的文件操作服务，支持读写、目录管理等功能",
          "iconUrl": "https://xxx/icon.png",
          "sourceType": "official",
          "sourceTypeLabel": "官方",
          "runtimeEnv": "nodejs",
          "category": {
            "id": 1,
            "name": "文件操作",
            "slug": "file-operation"
          },
          "author": {
            "id": 1001,
            "nickname": "Anthropic",
            "avatarUrl": "https://xxx/avatar.png"
          },
          "stats": {
            "downloadCount": 12500,
            "downloadCountFormatted": "12.5K",
            "favoriteCount": 856,
            "toolCount": 8,
            "ratingAvg": 4.8,
            "ratingCount": 126
          },
          "isFavorited": false,
          "publishedAt": "2025-11-15T10:00:00Z"
        }
      ],
      "pagination": {
        "page": 1,
        "pageSize": 20,
        "total": 1256,
        "totalPages": 63,
        "hasMore": true
      },
      "filters": {
        "appliedFilters": {
          "categoryId": 1,
          "sourceTypes": ["official", "verified"]
        },
        "availableFilters": {
          "categories": [...],
          "sourceTypes": [...],
          "runtimeEnvs": [...]
        }
      }
    }
  }

性能要求: 响应时间<300ms
缓存策略:
  - 无筛选条件的默认列表：Redis缓存，TTL=300秒
  - 有筛选条件：不缓存，实时查询ES
```

#### 业务规则

| 规则编号 | 规则描述 | 规则详情 |
|---------|---------|---------|
| BR-2.1.1 | 默认排序 | 综合推荐排序，权重公式：0.3×热度分 + 0.3×质量分 + 0.2×新鲜度 + 0.2×活跃度 |
| BR-2.1.2 | 数据范围 | 只展示status=2（已上架）且visibility=public的MCP |
| BR-2.1.3 | 分页限制 | 单页最多100条，总计最多展示10000条结果 |
| BR-2.1.4 | 卡片收藏 | 点击收藏按钮立即生效，未登录用户弹出登录提示 |
| BR-2.1.5 | 悬停延迟 | 鼠标悬停500ms后显示预览浮层，移开即关闭 |

---

### 2.3.2 功能点 F2.2：多条件组合筛选功能

#### 业务场景
```
场景一：精确筛选MCP
- 用户角色：有明确需求的开发者
- 用户目标：找到特定类型的MCP
- 使用路径：选择分类 → 选择运行环境 → 选择来源类型 → 查看筛选结果
- 期望结果：快速缩小范围，找到符合条件的MCP
```

#### 用户故事
```
US-2.2.1: 作为一名开发者，我希望同时按多个条件筛选，以便精确找到需要的MCP。
US-2.2.2: 作为一名用户，我希望看到每个筛选选项的匹配数量，以便了解筛选效果。
US-2.2.3: 作为一名用户，我希望能够一键清除所有筛选条件，以便重新开始筛选。
```

#### 界面设计说明

**筛选面板结构**：
```
┌──────────────────────────────────┐
│  筛选条件                        │
│  ────────────────────────────── │
│                                  │
│  功能分类                   [展开]│
│  ┌────────────────────────────┐ │
│  │ ☑ 文件操作 (1,256)         │ │
│  │ ☐ 数据存储 (892)           │ │
│  │ ☐ 网络通信 (743)           │ │
│  │ ☐ 开发工具 (1,089)         │ │
│  │ [展开更多...]              │ │
│  └────────────────────────────┘ │
│                                  │
│  来源类型                        │
│  ┌────────────────────────────┐ │
│  │ ☐ 官方 (128)               │ │
│  │ ☑ 认证 (356)               │ │
│  │ ☐ 社区 (10,892)            │ │
│  │ ☐ 托管 (67)                │ │
│  └────────────────────────────┘ │
│                                  │
│  运行环境                        │
│  ┌────────────────────────────┐ │
│  │ ☐ Node.js (5,632)          │ │
│  │ ☑ Python (4,128)           │ │
│  │ ☐ Docker (1,256)           │ │
│  │ ☐ Go (432)                 │ │
│  └────────────────────────────┘ │
│                                  │
│  评分区间                        │
│  ┌────────────────────────────┐ │
│  │ ○ 全部                      │ │
│  │ ○ 4.5分及以上 ⭐⭐⭐⭐⭐      │ │
│  │ ● 4.0分及以上 ⭐⭐⭐⭐        │ │
│  │ ○ 3.0分及以上 ⭐⭐⭐          │ │
│  └────────────────────────────┘ │
│                                  │
│  ────────────────────────────── │
│  已选条件：                      │
│  [文件操作 ×] [认证 ×] [Python ×]│
│                                  │
│  [重置筛选]                      │
└──────────────────────────────────┘
```

**筛选维度配置**：
| 筛选维度 | 类型 | 选项来源 | 多选支持 |
|---------|------|---------|---------|
| 功能分类 | 复选框 | mcp_category表 | 是（OR逻辑）|
| 来源类型 | 复选框 | 枚举值 | 是（OR逻辑）|
| 运行环境 | 复选框 | 枚举值 | 是（OR逻辑）|
| 评分区间 | 单选框 | 固定选项 | 否 |
| 标签 | 标签选择器 | mcp_tag表 | 是（AND逻辑）|

**筛选交互规则**：
| 交互行为 | 系统响应 |
|---------|---------|
| 勾选/取消筛选项 | 立即触发列表刷新，URL参数同步更新 |
| 点击已选条件标签的× | 移除该筛选条件，刷新列表 |
| 点击"重置筛选" | 清除所有筛选条件，恢复默认列表 |
| 刷新/返回页面 | 从URL参数恢复筛选状态 |

#### 接口设计

**接口：获取筛选选项及计数**
```yaml
接口路径: GET /api/v1/mcp/servers/filters
请求参数:
  - currentFilters: object, 可选, 当前已应用的筛选条件
响应格式:
  {
    "code": 200,
    "data": {
      "categories": [
        {"id": 1, "name": "文件操作", "slug": "file-operation", "count": 1256},
        {"id": 2, "name": "数据存储", "slug": "data-storage", "count": 892}
      ],
      "sourceTypes": [
        {"value": "official", "label": "官方", "count": 128},
        {"value": "verified", "label": "认证", "count": 356},
        {"value": "community", "label": "社区", "count": 10892},
        {"value": "hosted", "label": "托管", "count": 67}
      ],
      "runtimeEnvs": [
        {"value": "nodejs", "label": "Node.js", "count": 5632},
        {"value": "python", "label": "Python", "count": 4128},
        {"value": "docker", "label": "Docker", "count": 1256},
        {"value": "go", "label": "Go", "count": 432}
      ],
      "ratingRanges": [
        {"value": "4.5", "label": "4.5分及以上", "count": 523},
        {"value": "4.0", "label": "4.0分及以上", "count": 1892},
        {"value": "3.0", "label": "3.0分及以上", "count": 5632}
      ]
    }
  }
缓存策略: Redis缓存，TTL=600秒，数据变更时失效
```

#### 业务规则

| 规则编号 | 规则描述 | 规则详情 |
|---------|---------|---------|
| BR-2.2.1 | 同维度多选 | 同一筛选维度内多选时使用OR逻辑 |
| BR-2.2.2 | 跨维度组合 | 不同筛选维度之间使用AND逻辑 |
| BR-2.2.3 | 计数更新 | 筛选选项的计数应反映当前其他筛选条件下的可用数量 |
| BR-2.2.4 | URL同步 | 筛选条件变更时同步到URL查询参数，支持分享和书签 |
| BR-2.2.5 | 空结果处理 | 筛选结果为空时显示"无匹配结果"并建议放宽条件 |

---

### 2.3.3 功能点 F2.3：关键词搜索与高亮

#### 业务场景
```
场景一：精确搜索
- 用户角色：知道MCP名称的用户
- 用户目标：直接找到目标MCP
- 使用路径：输入MCP名称 → 回车搜索 → 查看结果
- 期望结果：目标MCP出现在搜索结果首位
```

#### 用户故事
```
US-2.3.1: 作为一名用户，我希望搜索时能匹配MCP的名称、描述和工具名称。
US-2.3.2: 作为一名用户，我希望搜索关键词在结果中高亮显示，以便快速定位匹配内容。
US-2.3.3: 作为一名用户，我希望搜索响应迅速，即使在大量数据中也能快速返回结果。
```

#### 界面设计说明

**搜索结果高亮展示**：
```
┌─────────────────────────────────────┐
│  ┌─────┐                           │
│  │     │  <em>File</em>system      │  ← 名称高亮
│  │ 图标 │  Anthropic               │
│  │     │                           │
│  └─────┘  [官方] [<em>文件</em>操作]│  ← 标签高亮
├─────────────────────────────────────┤
│  安全的<em>文件</em>操作服务，支持   │  ← 描述高亮
│  读写、目录管理等功能...            │
├─────────────────────────────────────┤
│  ⭐ 4.8   📥 12.5K   🔧 8          │
└─────────────────────────────────────┘
```

**搜索配置**：
| 配置项 | 值 | 说明 |
|-------|-----|------|
| 最小关键词长度 | 2字符 | 少于2字符不触发搜索 |
| 搜索防抖时间 | 300ms | 输入停止300ms后触发搜索 |
| 搜索字段权重 | name:10, description:5, tool_name:3 | 名称匹配权重最高 |
| 高亮标签 | `<em>...</em>` | 前端使用CSS样式渲染 |

#### 接口设计

```yaml
接口说明: 搜索功能集成在列表接口中，通过keyword参数触发
额外响应字段:
  - highlight: 高亮后的文本片段
  - matchedFields: 匹配的字段列表
  - score: 搜索相关度分数
```

#### 业务规则

| 规则编号 | 规则描述 | 规则详情 |
|---------|---------|---------|
| BR-2.3.1 | 搜索范围 | 搜索字段包括：名称、描述、工具名称、标签名称 |
| BR-2.3.2 | 匹配方式 | 默认使用模糊匹配，使用双引号包裹时精确匹配 |
| BR-2.3.3 | 排序规则 | 有搜索关键词时，默认按相关度排序 |
| BR-2.3.4 | 性能要求 | 搜索响应时间<200ms |

---

### 2.3.4 功能点 F2.4：多维度排序切换功能

#### 界面设计说明

**排序选择器**：
```
┌─────────────────────────────────────┐
│  排序：[综合推荐 ▼]                  │
├─────────────────────────────────────┤
│  ● 综合推荐（默认）                  │
│  ○ 最新发布                         │
│  ○ 下载量最多                       │
│  ○ 评分最高                         │
│  ○ 收藏最多                         │
│  ○ 最近更新                         │
└─────────────────────────────────────┘
```

**排序规则配置**：
| 排序选项 | 排序字段 | 排序方向 | 说明 |
|---------|---------|---------|------|
| 综合推荐 | composite_score | DESC | 多因素加权计算 |
| 最新发布 | published_at | DESC | 上架时间倒序 |
| 下载量最多 | download_count | DESC | 总下载量倒序 |
| 评分最高 | rating_avg | DESC | 评分倒序，评价数≥10 |
| 收藏最多 | favorite_count | DESC | 收藏数倒序 |
| 最近更新 | updated_at | DESC | 更新时间倒序 |

---

### 2.3.5 功能点 F2.5：选项卡快速分类导航

#### 界面设计说明

**选项卡导航**：
```
┌─────────────────────────────────────────────────────────────────────┐
│  [全部(12,580)] [今日推荐(24)] [精选(128)] [最新(256)] [官方(856)] [托管(67)] │
└─────────────────────────────────────────────────────────────────────┘
```

**选项卡配置**：
| 选项卡 | 筛选条件 | 排序方式 | 说明 |
|-------|---------|---------|------|
| 全部 | 无 | 综合推荐 | 全量数据 |
| 今日推荐 | is_daily_pick=1 | 推荐权重 | 每日运营精选 |
| 精选 | is_featured=1 | 精选权重 | 编辑精选 |
| 最新 | published_at>7天内 | 发布时间倒序 | 近7天上架 |
| 官方认证 | source_type='official' | 综合推荐 | 官方MCP |
| 托管服务 | source_type='hosted' | 综合推荐 | 平台托管MCP |

---

### 2.3.6 功能点 F2.6：列表与卡片视图切换

#### 界面设计说明

**视图切换按钮**：
```
视图：[▦ 卡片] [≡ 列表]
```

**列表视图行结构**：
```
┌───────┬────────────────────────────────────┬──────────┬──────────┬─────────┐
│ [图标] │ Filesystem                        │ ⭐ 4.8   │ 📥 12.5K │ [收藏]  │
│       │ 安全的文件操作服务...  [官方][文件] │ (126评价)│          │ [详情]  │
└───────┴────────────────────────────────────┴──────────┴──────────┴─────────┘
```

---

### 2.3.7 功能点 F2.7：无限滚动分页加载

#### 业务规则

| 规则编号 | 规则描述 | 规则详情 |
|---------|---------|---------|
| BR-2.7.1 | 触发时机 | 滚动到距底部200px时触发加载下一页 |
| BR-2.7.2 | 加载数量 | 每次加载20条数据 |
| BR-2.7.3 | 最大数量 | 无限滚动最多加载500条，超出提示使用筛选 |
| BR-2.7.4 | 模式切换 | 可切换为传统分页模式 |

---

### 2.3.8 功能点 F2.8：批量操作与对比功能

#### 界面设计说明

**批量选择模式**：
```
┌─────────────────────────────────────────────────────────────────────┐
│  ☑ 批量选择模式                    已选择 3 个                       │
│  ────────────────────────────────────────────────────────────────── │
│  [批量收藏] [批量生成配置] [对比选中项] [取消选择]                     │
└─────────────────────────────────────────────────────────────────────┘
```

**对比功能界面**：
```
┌───────────────────────────────────────────────────────────────────────────┐
│  MCP对比                                                         [关闭]  │
├───────────────┬───────────────┬───────────────┬───────────────────────────┤
│               │  Filesystem   │  File Manager │  File Converter          │
├───────────────┼───────────────┼───────────────┼───────────────────────────┤
│ 来源类型       │  官方          │  认证          │  社区                     │
│ 运行环境       │  Node.js      │  Python       │  Docker                   │
│ 工具数量       │  8            │  12           │  5                        │
│ 评分          │  ⭐4.8        │  ⭐4.6        │  ⭐4.2                     │
│ 下载量        │  12.5K        │  8.2K         │  3.1K                     │
├───────────────┼───────────────┼───────────────┼───────────────────────────┤
│ 工具列表       │               │               │                           │
│ • read_file  │  ✓            │  ✓            │  ✗                        │
│ • write_file │  ✓            │  ✓            │  ✓                        │
│ • delete     │  ✓            │  ✓            │  ✗                        │
├───────────────┼───────────────┼───────────────┼───────────────────────────┤
│               │  [查看详情]    │  [查看详情]    │  [查看详情]                │
└───────────────┴───────────────┴───────────────┴───────────────────────────┘
```

#### 业务规则

| 规则编号 | 规则描述 | 规则详情 |
|---------|---------|---------|
| BR-2.8.1 | 对比数量 | 最少2个，最多4个MCP |
| BR-2.8.2 | 对比维度 | 基本信息、统计数据、工具列表、标签 |
| BR-2.8.3 | 批量收藏 | 未登录用户弹出登录提示 |

---

## 2.4 数据模型补充

**MCP工具表 mcp_tool**：
```sql
CREATE TABLE mcp_tool (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    mcp_server_id BIGINT NOT NULL COMMENT '所属MCP ID',
    name VARCHAR(100) NOT NULL COMMENT '工具名称',
    description VARCHAR(500) COMMENT '工具描述',
    input_schema JSON COMMENT '输入参数Schema（JSON Schema格式）',
    output_schema JSON COMMENT '输出Schema',
    is_deprecated TINYINT DEFAULT 0 COMMENT '是否已废弃',
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    INDEX idx_mcp_server (mcp_server_id)
) COMMENT 'MCP工具表';
```

**用户收藏表 user_favorite**：
```sql
CREATE TABLE user_favorite (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    user_id BIGINT NOT NULL COMMENT '用户ID',
    mcp_server_id BIGINT NOT NULL COMMENT 'MCP服务器ID',
    folder_id BIGINT COMMENT '收藏夹ID',
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    UNIQUE KEY uk_user_mcp (user_id, mcp_server_id),
    INDEX idx_user (user_id),
    INDEX idx_mcp (mcp_server_id)
) COMMENT '用户收藏表';
```

---

## 2.5 页面状态设计

### 2.5.1 加载状态
| 场景 | 展示方式 |
|-----|---------|
| 首次加载 | 列表区域显示12个骨架屏卡片 |
| 加载更多 | 列表底部显示加载指示器 |
| 筛选切换 | 列表区域整体显示加载遮罩 |

### 2.5.2 空状态
| 场景 | 展示内容 |
|-----|---------|
| 搜索无结果 | "未找到匹配的MCP，试试其他关键词？" + 热门搜索推荐 |
| 筛选无结果 | "当前筛选条件无匹配结果" + [放宽条件] [重置筛选] |
| 分类无数据 | "该分类暂无MCP，敬请期待" |

### 2.5.3 错误状态
| 错误类型 | 处理方式 |
|---------|---------|
| 加载失败 | 显示错误提示和重试按钮 |
| 部分失败 | 显示已加载内容，顶部toast提示 |

---

## 2.6 埋点设计

| 事件名 | 触发时机 | 携带参数 |
|-------|---------|---------|
| list_page_view | 页面加载 | tab, filters |
| search_execute | 搜索执行 | keyword, result_count |
| filter_apply | 应用筛选 | filter_type, filter_value |
| sort_change | 切换排序 | sort_by |
| view_switch | 切换视图 | view_type |
| card_click | 点击卡片 | mcp_id, position |
| card_favorite | 点击收藏 | mcp_id |
| compare_open | 打开对比 | mcp_ids |
| load_more | 加载更多 | page, trigger_type |

---

这是模块二（MCP服务器列表）的详细产品设计文档。
