<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ReAct æ™ºèƒ½åŠ©æ‰‹</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 10px;
            margin: 0;
            /* ä¸¥æ ¼é™åˆ¶åœ¨å·¦ä¾§30%åŒºåŸŸå†… */
            width: 30vw;
            max-width: 30vw;
            overflow-x: hidden;
            overflow-y: auto;
        }

        .container {
            width: 100%;
            max-width: 100%;
            margin: 0;
            padding: 0;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 15px;
        }

        .header h1 {
            font-size: 1.4em;
            margin-bottom: 5px;
        }

        .header p {
            font-size: 0.85em;
            opacity: 0.9;
        }

        .card {
            background: white;
            border-radius: 8px;
            padding: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);
            margin-bottom: 10px;
        }

        .input-section {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            margin-bottom: 10px;
        }

        #taskInput {
            flex: 1;
            min-width: 100%;
            padding: 8px 10px;
            font-size: 13px;
            border: 2px solid #e0e0e0;
            border-radius: 6px;
            outline: none;
            transition: border-color 0.3s;
        }

        #taskInput:focus {
            border-color: #667eea;
        }

        .btn {
            padding: 8px 14px;
            font-size: 13px;
            font-weight: 600;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
            min-width: 80px;
            flex: 1;
        }

        .btn-primary {
            background: #667eea;
            color: white;
        }

        .btn-primary:hover:not(:disabled) {
            background: #5568d3;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: #f0f0f0;
            color: #666;
        }

        .btn-secondary:hover:not(:disabled) {
            background: #e0e0e0;
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .examples {
            margin-bottom: 8px;
        }

        .examples h3 {
            font-size: 12px;
            color: #666;
            margin-bottom: 5px;
        }

        .example-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 4px;
        }

        .example-tag {
            padding: 4px 8px;
            background: #f5f5f5;
            border: 1px solid #e0e0e0;
            border-radius: 4px;
            font-size: 11px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .example-tag:hover {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        #output {
            min-height: 150px;
            max-height: 300px;
            overflow-y: auto;
        }

        .step {
            margin-bottom: 8px;
            padding: 8px;
            border-radius: 6px;
            animation: slideIn 0.3s ease-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .step-thought {
            background: #f0f7ff;
            border-left: 4px solid #4a90e2;
        }

        .step-action {
            background: #fff8e1;
            border-left: 4px solid #ffa726;
        }

        .step-observation {
            background: #f1f8f4;
            border-left: 4px solid #66bb6a;
        }

        .step-final {
            background: #f3e5f5;
            border-left: 4px solid #ab47bc;
            font-weight: 500;
        }

        .step-header {
            display: flex;
            align-items: center;
            gap: 5px;
            margin-bottom: 5px;
            font-weight: 600;
            font-size: 12px;
        }

        .step-icon {
            width: 16px;
            height: 16px;
        }

        .step-content {
            color: #333;
            line-height: 1.4;
            font-size: 12px;
        }

        .step-meta {
            margin-top: 5px;
            padding-top: 5px;
            border-top: 1px solid rgba(0, 0, 0, 0.1);
            font-size: 10px;
            color: #666;
        }

        .code {
            background: #f5f5f5;
            padding: 1px 4px;
            border-radius: 2px;
            font-family: 'Courier New', monospace;
            font-size: 11px;
        }

        .loading {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px;
            color: #666;
            font-size: 12px;
        }

        .spinner {
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .empty-state {
            text-align: center;
            padding: 30px 10px;
            color: #999;
        }

        .empty-state-icon {
            font-size: 32px;
            margin-bottom: 8px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ¤– ReAct æ™ºèƒ½åŠ©æ‰‹</h1>
            <p>åŸºäº ReAct æ¡†æ¶çš„æ™ºèƒ½åŠ©æ‰‹ï¼šæ”¯æŒæ•°å­¦è®¡ç®—ã€æ–‡ä»¶æ“ä½œã€æ–‡æ¡£è¯»å–ã€æµè§ˆå™¨è‡ªåŠ¨åŒ–</p>
        </div>

        <div class="card">
            <div class="examples">
                <h3>ğŸ­ Playwright æµè§ˆå™¨è‡ªåŠ¨åŒ–ç¤ºä¾‹ï¼ˆåŸºç¡€æ“ä½œï¼‰ï¼š</h3>
                <div class="example-tags">
                    <span class="example-tag" onclick="setTask('è®¿é—® https://example.com å¹¶è·å–é¡µé¢æ ‡é¢˜')">ğŸŒ æ‰“å¼€ç½‘é¡µ</span>
                    <span class="example-tag" onclick="setTask('æ‰“å¼€ç™¾åº¦é¦–é¡µï¼Œæœç´¢ Spring Boot æ•™ç¨‹')">ğŸ” è‡ªåŠ¨æœç´¢</span>
                    <span class="example-tag" onclick="setTask('è®¿é—® https://www.baidu.com å¹¶æˆªå›¾')">ğŸ“¸ ç½‘é¡µæˆªå›¾</span>
                    <span class="example-tag" onclick="setTask('æ‰“å¼€ example.com å¹¶ä½¿ç”¨ JavaScript è·å–é¡µé¢ URL')">âš™ï¸ æ‰§è¡Œ JS</span>
                    <span class="example-tag" onclick="setTask('æ‰“å¼€ https://example.com è·å–æ‰€æœ‰å¯è§æ–‡æœ¬')">ğŸ“„ æå–æ–‡æœ¬</span>
                </div>
            </div>
            
            <div class="examples">
                <h3>ğŸš€ é«˜çº§æµè§ˆå™¨æ“ä½œï¼ˆæ–°åŠŸèƒ½ï¼‰ï¼š</h3>
                <div class="example-tags">
                    <span class="example-tag" onclick="setTask('è®¿é—® https://www.baidu.comï¼Œè·å–é¡µé¢çš„ HTML å†…å®¹')">ğŸ“‹ è·å– HTML</span>
                    <span class="example-tag" onclick="setTask('æ‰“å¼€ https://example.comï¼Œè·å–æµè§ˆå™¨æ§åˆ¶å°æ—¥å¿—')">ğŸ“Š æ§åˆ¶å°æ—¥å¿—</span>
                    <span class="example-tag" onclick="setTask('è®¿é—®æ·˜å®é¦–é¡µï¼Œæ‚¬åœåœ¨åˆ†ç±»èœå•ä¸Š')">ğŸ–±ï¸ é¼ æ ‡æ‚¬åœ</span>
                    <span class="example-tag" onclick="setTask('æ‰“å¼€è´­ç‰©ç½‘ç«™ï¼Œé€‰æ‹©ä¸‹æ‹‰æ¡†ä¸­çš„é€‰é¡¹')">ğŸ“ é€‰æ‹©ä¸‹æ‹‰æ¡†</span>
                    <span class="example-tag" onclick="setTask('è®¿é—® https://www.example.comï¼Œå¯¹æ•´ä¸ªé¡µé¢æˆªå›¾')">ğŸ–¼ï¸ å…¨é¡µæˆªå›¾</span>
                </div>
            </div>
            
            <div class="examples">
                <h3>ğŸ¯ ç»¼åˆåœºæ™¯ç¤ºä¾‹ï¼š</h3>
                <div class="example-tags">
                    <span class="example-tag" onclick="setTask('è®¿é—®ç™¾åº¦ï¼Œæœç´¢ AI äººå·¥æ™ºèƒ½ï¼Œç‚¹å‡»ç¬¬ä¸€ä¸ªæœç´¢ç»“æœå¹¶è·å–æ–°é¡µé¢æ ‡é¢˜')">ğŸ”— å¤šé¡µé¢æ“ä½œ</span>
                    <span class="example-tag" onclick="setTask('æ‰“å¼€æ·˜å®é¦–é¡µï¼Œæœç´¢ MacBookï¼Œæˆªå›¾å‰ 3 ä¸ªå•†å“')">ğŸ›’ ç”µå•†æœç´¢</span>
                    <span class="example-tag" onclick="setTask('è®¿é—®æ–°é—»ç½‘ç«™ï¼Œæå–é¦–é¡µæ‰€æœ‰æ ‡é¢˜å¹¶ä¿å­˜ä¸ºæ–‡æœ¬')">ğŸ“° å†…å®¹æŠ“å–</span>
                    <span class="example-tag" onclick="setTask('æ‰“å¼€ GitHubï¼Œæœç´¢ Spring Boot é¡¹ç›®ï¼Œè·å–å‰ 5 ä¸ªé¡¹ç›®çš„æ˜Ÿæ ‡æ•°')">â­ æ•°æ®é‡‡é›†</span>
                </div>
            </div>
            
            <div class="examples">
                <h3>ğŸ§® æ•°å­¦è®¡ç®—ç¤ºä¾‹ï¼š</h3>
                <div class="example-tags">
                    <span class="example-tag" onclick="setTask('è®¡ç®— 123 åŠ  456')">â• åŠ æ³•</span>
                    <span class="example-tag" onclick="setTask('è®¡ç®— 100 å‡ 37')">â– å‡æ³•</span>
                    <span class="example-tag" onclick="setTask('è®¡ç®— 15 ä¹˜ä»¥ 8')">âœ–ï¸ ä¹˜æ³•</span>
                    <span class="example-tag" onclick="setTask('è®¡ç®— 144 é™¤ä»¥ 12')">â— é™¤æ³•</span>
                </div>
            </div>
            
            <div class="examples">
                <h3>ğŸ“ æ–‡ä»¶æ“ä½œç¤ºä¾‹ï¼š</h3>
                <div class="example-tags">
                    <span class="example-tag" onclick="setTask('åˆ—å‡º /tmp ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶')">ğŸ“‚ åˆ—å‡ºç›®å½•</span>
                    <span class="example-tag" onclick="setTask('åœ¨ /tmp ç›®å½•åˆ›å»ºä¸€ä¸ª test.txt æ–‡ä»¶ï¼Œå†…å®¹ä¸º Hello Playwright MCP')">ğŸ“ åˆ›å»ºæ–‡ä»¶</span>
                    <span class="example-tag" onclick="setTask('è¯»å– /tmp/test.txt çš„å†…å®¹')">ğŸ“– è¯»å–æ–‡ä»¶</span>
                </div>
            </div>

            <div class="input-section">
                <input 
                    type="text" 
                    id="taskInput" 
                    placeholder="è¾“å…¥ä»»åŠ¡ï¼Œæ”¯æŒæµè§ˆå™¨è‡ªåŠ¨åŒ–ã€æ•°å­¦è®¡ç®—ã€æ–‡ä»¶æ“ä½œç­‰"
                    onkeypress="if(event.key==='Enter') solveTask()"
                />
                <button class="btn btn-primary" id="solveBtn" onclick="solveTask()">
                    å¼€å§‹æ‰§è¡Œ
                </button>
                <button class="btn btn-secondary" id="clearBtn" onclick="clearOutput()">
                    æ¸…ç©º
                </button>
            </div>
        </div>

        <div class="card">
            <div id="output">
                <div class="empty-state">
                    <div class="empty-state-icon">ğŸ’­</div>
                    <p>è¾“å…¥ä¸€ä¸ªä»»åŠ¡ï¼Œè§‚çœ‹ AI çš„æ€è€ƒä¸æ‰§è¡Œè¿‡ç¨‹</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Spring Boot API æœåŠ¡åœ°å€
        const API_BASE_URL = 'http://localhost:8080';
        
        let eventSource = null;

        function setTask(task) {
            document.getElementById('taskInput').value = task;
        }

        function clearOutput() {
            const output = document.getElementById('output');
            output.innerHTML = `
                <div class="empty-state">
                    <div class="empty-state-icon">ğŸ’­</div>
                    <p>è¾“å…¥ä¸€ä¸ªä»»åŠ¡ï¼Œè§‚çœ‹ AI çš„æ€è€ƒä¸æ‰§è¡Œè¿‡ç¨‹</p>
                </div>
            `;
        }

        function solveTask() {
            const task = document.getElementById('taskInput').value.trim();
            if (!task) {
                alert('è¯·è¾“å…¥ä»»åŠ¡');
                return;
            }

            // å…³é—­ä¹‹å‰çš„è¿æ¥
            if (eventSource) {
                eventSource.close();
            }

            // æ¸…ç©ºè¾“å‡ºå¹¶æ˜¾ç¤ºåŠ è½½çŠ¶æ€
            const output = document.getElementById('output');
            output.innerHTML = `
                <div class="loading">
                    <div class="spinner"></div>
                    <span>AI æ­£åœ¨æ€è€ƒä¸­...</span>
                </div>
            `;

            // ç¦ç”¨æŒ‰é’®
            const solveBtn = document.getElementById('solveBtn');
            const taskInput = document.getElementById('taskInput');
            solveBtn.disabled = true;
            taskInput.disabled = true;
            solveBtn.textContent = 'æ‰§è¡Œä¸­...';

            // å»ºç«‹ SSE è¿æ¥ - ä½¿ç”¨å®Œæ•´çš„ API åœ°å€
            const encodedTask = encodeURIComponent(task);
            eventSource = new EventSource(`${API_BASE_URL}/react/solve-stream?task=${encodedTask}`);

            // ç›‘å¬å„ç±»äº‹ä»¶
            eventSource.addEventListener('thought', (e) => {
                const data = JSON.parse(e.data);
                appendStep('thought', 'ğŸ’­ AI æ€è€ƒ', data.content);
            });

            eventSource.addEventListener('action', (e) => {
                const data = JSON.parse(e.data);
                const toolDesc = getToolDescription(data.toolName, data.toolInput);
                appendStep('action', 'ğŸ”§ è°ƒç”¨å·¥å…·', toolDesc);
            });

            eventSource.addEventListener('final_answer', (e) => {
                const data = JSON.parse(e.data);
                appendStep('final', 'âœ… æœ€ç»ˆç­”æ¡ˆ', data.content);
                
                // å…³é—­è¿æ¥å¹¶æ¢å¤æŒ‰é’®
                eventSource.close();
                solveBtn.disabled = false;
                taskInput.disabled = false;
                solveBtn.textContent = 'å¼€å§‹æ‰§è¡Œ';
            });

            eventSource.onerror = (e) => {
                console.error('SSE è¿æ¥é”™è¯¯:', e);
                eventSource.close();
                
                output.innerHTML += `
                    <div class="step" style="background: #ffebee; border-left: 4px solid #f44336;">
                        <div class="step-header">
                            <span>âŒ è¿æ¥é”™è¯¯</span>
                        </div>
                        <div class="step-content">æ— æ³•è¿æ¥åˆ°æœåŠ¡å™¨ï¼Œè¯·æ£€æŸ¥åç«¯æœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œ</div>
                    </div>
                `;
                
                solveBtn.disabled = false;
                taskInput.disabled = false;
                solveBtn.textContent = 'å¼€å§‹æ‰§è¡Œ';
            };
        }

        function appendStep(type, header, content, meta) {
            const output = document.getElementById('output');
            
            // ç§»é™¤ç©ºçŠ¶æ€å’ŒåŠ è½½çŠ¶æ€
            const emptyState = output.querySelector('.empty-state');
            const loading = output.querySelector('.loading');
            if (emptyState) emptyState.remove();
            if (loading) loading.remove();

            const step = document.createElement('div');
            step.className = `step step-${type}`;
            
            step.innerHTML = `
                <div class="step-header">
                    <span>${header}</span>
                </div>
                <div class="step-content">${content}</div>
            `;
            
            output.appendChild(step);
            
            // æ»šåŠ¨åˆ°åº•éƒ¨
            output.scrollTop = output.scrollHeight;
        }

        function getToolDescription(toolName, toolInput) {
            try {
                const params = JSON.parse(toolInput);
                const descriptions = {
                    // Playwright æµè§ˆå™¨è‡ªåŠ¨åŒ–å·¥å…·ï¼ˆåŸºç¡€ï¼‰
                    'navigate': `ğŸŒ æ‰“å¼€ç½‘é¡µ: <code class="code">${params.url}</code> ${params.headless ? '(æ— å¤´æ¨¡å¼)' : '(æœ‰å¤´æ¨¡å¼)'}`,
                    'click': `ğŸ‘† ç‚¹å‡»å…ƒç´ : <code class="code">${params.selector}</code>`,
                    'fill': `âŒ¨ï¸ è¾“å…¥æ–‡æœ¬: <code class="code">${params.selector}</code> = "${params.text}"`,
                    'evaluate': `âš™ï¸ æ‰§è¡Œ JS: <code class="code">${params.script?.substring(0, 50)}...</code>`,
                    'closeBrowser': `ğŸšª å…³é—­æµè§ˆå™¨`,
                    'getPageInfo': `â„¹ï¸ è·å–é¡µé¢ä¿¡æ¯`,
                    'analyzePage': `ğŸ” åˆ†æé¡µé¢ç»“æ„`,
                    // Playwright é«˜çº§å·¥å…·
                    'screenshot': `ğŸ“¸ ${params.fullPage ? 'å…¨é¡µæˆªå›¾' : 'è§†å£æˆªå›¾'}${params.selector ? ': ' + params.selector : ''}`,
                    'getConsoleLogs': `ğŸ“Š è·å–æ§åˆ¶å°æ—¥å¿— (ç±»å‹: ${params.type || 'all'}, é™åˆ¶: ${params.limit || 50} æ¡)`,
                    'hover': `ğŸ–±ï¸ é¼ æ ‡æ‚¬åœ: <code class="code">${params.selector}</code>`,
                    'select': `ğŸ“ é€‰æ‹©ä¸‹æ‹‰æ¡†: <code class="code">${params.selector}</code> = "${params.value}"`,
                    'uploadFile': `ğŸ“¤ ä¸Šä¼ æ–‡ä»¶: <code class="code">${params.selector}</code> â† "${params.filePath}"`,
                    'getVisibleText': `ğŸ“„ è·å–å¯è§æ–‡æœ¬`,
                    'getVisibleHtml': `ğŸ“‹ è·å– HTML${params.cleanHtml ? ' (å·²æ¸…ç†)' : ''}${params.selector ? ': ' + params.selector : ''}`,
                    'clickAndSwitchTab': `ğŸªŸ ç‚¹å‡»å¹¶åˆ‡æ¢æ ‡ç­¾é¡µ: <code class="code">${params.selector}</code>`,
                    'iframeClick': `ğŸ”² iframe ä¸­ç‚¹å‡»: <code class="code">${params.iframeSelector}</code> â†’ <code class="code">${params.selector}</code>`,
                    'iframeFill': `ğŸ”² iframe ä¸­å¡«å†™: <code class="code">${params.iframeSelector}</code> â†’ <code class="code">${params.selector}</code> = "${params.text}"`,
                    // æ—§çš„å·¥å…·åï¼ˆå…¼å®¹ï¼‰
                    'getText': `ğŸ“„ è·å–æ–‡æœ¬: <code class="code">${params.selector}</code>`,
                    'waitTime': `â±ï¸ ç­‰å¾…: ${params.milliseconds}ms`,
                    // æ•°å­¦å·¥å…·
                    'add': `â• åŠ æ³•ï¼š${params.a} + ${params.b}`,
                    'subtract': `â– å‡æ³•ï¼š${params.a} - ${params.b}`,
                    'multiply': `âœ–ï¸ ä¹˜æ³•ï¼š${params.a} Ã— ${params.b}`,
                    'divide': `â— é™¤æ³•ï¼š${params.a} Ã· ${params.b}`,
                    // æ–‡ä»¶ç³»ç»Ÿå·¥å…·
                    'readFile': `ğŸ“– è¯»å–æ–‡æœ¬æ–‡ä»¶: <code class="code">${params.filePath}</code>`,
                    'writeFile': `ğŸ“ å†™å…¥æ–‡ä»¶: <code class="code">${params.filePath}</code> (${params.content?.length || 0} å­—èŠ‚)`,
                    'listFiles': `ğŸ“‚ åˆ—å‡ºç›®å½•: <code class="code">${params.directoryPath}</code> ${params.recursive ? '(é€’å½’)' : ''}`,
                    'createDirectory': `ğŸ“ åˆ›å»ºç›®å½•: <code class="code">${params.directoryPath}</code>`,
                    'deleteFile': `ğŸ—‘ï¸ åˆ é™¤æ–‡ä»¶: <code class="code">${params.filePath}</code>`,
                    'copyFile': `ğŸ“‹ å¤åˆ¶æ–‡ä»¶: <code class="code">${params.sourcePath}</code> â†’ <code class="code">${params.targetPath}</code>`,
                    'moveFile': `ğŸ“¦ ç§»åŠ¨æ–‡ä»¶: <code class="code">${params.sourcePath}</code> â†’ <code class="code">${params.targetPath}</code>`,
                    // Office æ–‡æ¡£å·¥å…·
                    'readWordDocument': `ğŸ“˜ è¯»å– Word: <code class="code">${params.filePath}</code>`,
                    'readExcelDocument': `ğŸ“Š è¯»å– Excel: <code class="code">${params.filePath}</code> (æœ€å¤š ${params.maxRows || 100} è¡Œ)`
                };
                return descriptions[toolName] || `${toolName}(${toolInput})`;
            } catch (e) {
                return `${toolName}(...)`;
            }
        }

        // é¡µé¢åŠ è½½å®Œæˆåèšç„¦è¾“å…¥æ¡†
        window.onload = () => {
            document.getElementById('taskInput').focus();
        };
    </script>
</body>
</html>
